---
title: Использовать общий транспорт
description: Настройка позволяет уменьшить количество открытых соединений с сервером
categories: [Best practices]
tags: [best_practices, shared_client]
weight: 3
---

## Общий принцип

### Транспортный клиент

По умолчанию, компоненты Pandora при создании нового Инстанса автоматически назначают ему транспортного клиента,
например, для http, grpc или tcp. Когда Инстанс запускается, он открывает соединение, например, tcp соединение.
Обычно, клиенты могут использовать несколько соединений одновременно, но в случае с Pandora,
каждый Инстанс открывает только одно соединение, так как Инстанс выполняет запросы один за другим.

Стоит заметить, что создание соединения не означает, что запросы будут идти через это соединение. Почему?
В настройках теста можно указать большое кол-во инстансов и маленькое кол-во RPS.
Провайдер Пандора генерирует запросы с частотой указаной в настройках RPS и передает на случайный инстанс, чтобы
инстанс выполнил этот запрос.

## `shared-client`

В настройках генераторов [http](../http-generator.md) и [grpc](../grpc-generator.md) можно указать параметр `shared-client.enabled=true`.
Если включить данную настройку, то все инстансы будут использовать общий транспортный клиент и каждый не будет
создавать собственный.

## `shared-client.client-number`

Транспортный клиент использует для подключения соединения. Например, HTTP и gRPC используют tcp соединение.
Один клиент использует нескоклько соединений. И может создавать дополнительные при непобходимости.

Но при больших нагрузках может возникнуть ситуация, когда клиент не успевает создать соединения.
Можно увеличить, скорость создания соединений общим клиентом, увеличив параметро `shared-client.client-number`.
По умолчанию `shared-client.client-number=1`
